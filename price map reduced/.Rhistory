library(lars)
library(fields)
library(gwrr)
## LOg PRICE MAP utm
log.price.map.centroids.xy <- read.csv("~/DTU/3. semestr/GIS/project/price map centroids xy/log price map centroids xy.csv", sep=";")
View(log.price.map.centroids.xy)
locs <- cbind(log.price.map.centroids.xy$X, log.price.map.centroids.xy$Y)
gwrr_exp <-gwrr.est(CENA ~ AREA_SQ_M +
HUBDISTBUS+HUBDISTMET+HUBDISTTRA+HUBDISTTR2, locs, price.map.centroids.xy, kernel = "exp",bw = TRUE, rd = TRUE)
##PRICE MAP utm
log.price.map.centroids.xy <- read.csv("~/DTU/3. semestr/GIS/project/price map centroids xy/price map centroids xy.csv", sep=";")
locs <- cbind(log.price.map.centroids.xy$X, log.price.map.centroids.xy$Y)
gwrr_exp <-gwrr.est(CENA ~ AREA_SQ_M +
HUBDISTBUS+HUBDISTMET+HUBDISTTRA+HUBDISTTR2, locs, price.map.centroids.xy, kernel = "exp",bw = TRUE, rd = TRUE)
##PRICE MAP utm
price.map.centroids.xy <- read.csv("~/DTU/3. semestr/GIS/project/price map centroids xy/price map centroids xy.csv", sep=";")
locs <- cbind(log.price.map.centroids.xy$X, log.price.map.centroids.xy$Y)
gwrr_exp <-gwrr.est(CENA ~ AREA_SQ_M +
HUBDISTBUS+HUBDISTMET+HUBDISTTRA+HUBDISTTR2, locs, price.map.centroids.xy, kernel = "exp",bw = TRUE, rd = TRUE)
locs <- cbind(log.price.map.centroids.xy$X, log.price.map.centroids.xy$Y)
locs <- cbind(price.map.centroids.xy$X, price.map.centroids.xy$Y)
gwrr_exp <-gwrr.est(CENA ~ AREA_SQ_M +
HUBDISTBUS+HUBDISTMET+HUBDISTTRA+HUBDISTTR2, locs, price.map.centroids.xy, kernel = "exp",bw = TRUE, rd = TRUE)
#Geographically weighted Ridge Regression with gaussian kernel
gwrr_gauss <-gwrr.est(CENA ~ AREA_SQ_M +
HUBDISTBUS+HUBDISTMET+HUBDISTTRA+HUBDISTTR2, locs, price.map.centroids.xy, kernel = "gauss",bw = TRUE, rd = TRUE)
library(GWmodel)
data(DubVoter)
bw.a <- bw.gwr(GenEl2004~DiffAdd+LARent+SC1+Unempl+LowEduc+Age18_24
+Age25_44+Age45_64,
data=Dub.voter,approach="AICc",kernel="bisquare",adaptive=TRUE)
gwr.res <- gwr.basic(GenEl2004~DiffAdd+LARent+SC1+Unempl+LowEduc+Age18_24
+Age25_44+Age45_64,
data=Dub.voter,bw=bw.a,kernel="bisquare",adaptive=TRUE,F123.test=TRUE)
View(Dub.voter)
ggplot(data = DubVoter) +
geom_sf() +
geom_point(data = sites, aes(x = longitude, y = latitude), size = 4,
shape = 23, fill = "darkred") +
coord_sf(xlim = c(-88, -78), ylim = c(24.5, 33), expand = FALSE)
library(ggplot)
install.packages("ggplot")
library(ggplot2)
ggplot(data = DubVoter) +
geom_sf() +
geom_point(data = sites, aes(x = longitude, y = latitude), size = 4,
shape = 23, fill = "darkred") +
coord_sf(xlim = c(-88, -78), ylim = c(24.5, 33), expand = FALSE)
locs <- cbind(DubVoter$X, DubVoter$Y)
View(Dub.voter)
locs <- cbind(Dub.Voter$X, Dub.Voter$Y)
DubVoter<-data(DubVoter)
data(DubVoter)
locs <- cbind(Dub.voter$X, Dub.voter$Y)
ggplot(data = Dub.voter) +
geom_sf() +
geom_point(data = sites, aes(x = longitude, y = latitude), size = 4,
shape = 23, fill = "darkred") +
coord_sf(xlim = c(-88, -78), ylim = c(24.5, 33), expand = FALSE)
ggplot(data = Dub.voter) +
geom_sf() +
geom_point(data = Dub.voter, aes(x = longitude, y = latitude), size = 4,
shape = 23, fill = "darkred") +
coord_sf(xlim = c(-88, -78), ylim = c(24.5, 33), expand = FALSE)
plot(Dub.voter$X, Dub.voter$Y)
log.price.map.centroids.xy <- read.csv("~/DTU/3. semestr/GIS/project/price map centroids xy/log price map centroids xy.csv", sep=";")
plot(log.price.map.centroids.xy$X, log.price.map.centroids.xy$Y)
library(spdep)
library(sp)
## PRICE MAP
setwd("~/DTU/3. semestr/GIS/project/price map centroids xy")
# Load the output area shapefiles
Output.Areas<- readOGR(".", "price map centroids xy")
library(tmap)
# Load the output area shapefiles
Output.Areas<- readOGR(".", "price map centroids xy")
# Load shapefile
pricemap <- read_sf('~/DTU/3. semestr/GIS/project/price map centroids xy utm.shp')
# Load shapefile
pricemap <- read_sf('~/DTU/3. semestr/GIS/project/price map centroids xy/price map centroids xy utm.shp')
View(pricemap)
library(rgdal)
# Load the output area shapefiles
pricemap<- readOGR(".", "price map centroids xy utm")
View(pricemap)
View(Dub.voter)
library(gwrr)
data(""columbus")
data("columbus")
View(columbus)
price.map.centroids.xy <- read.csv("~/DTU/3. semestr/GIS/project/price map centroids xy/price map centroids xy.csv", sep=";")
View(price.map.centroids.xy)
View(price.map.centroids.xy)
locs <- cbind(log.price.map.centroids.xy$X, log.price.map.centroids.xy$Y)
View(columbus)
price.map.centroids.xy.spdf <- SpatialPointsDataFrame(locs,price.map.centroids.xy)
View(price.map.centroids.xy.spdf)
View(Dub.voter)
View(pricemap)
View(Dub.voter)
View(Dub.voter)
View(Dub.voter)
## PRICE MAP
setwd("~/DTU/3. semestr/GIS/project/price map")
# Load the output area shapefiles
pricemap<- readOGR(".", "price map")
View(Dub.voter)
View(pricemap)
View(pricemap)
lcr.pricemap.bw <- bw.gwr.lcr(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA + HUBDISTTR2, data=pricemap, kernel = "gauss", adaptive=TRUE)
View(Dub.voter)
View(pricemap)
pricemap$Y
View(Dub.voter)
Dub.voter$Y
lcr.pricemap.bw <- bw.gwr.lcr(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA + HUBDISTTR2, data=price.map.centroids.xy.spdf, kernel = "gauss", adaptive=TRUE)
lcrm1 <- gwr.lcr(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA + HUBDISTTR2, data=pricemap, bw=2308, kernel = "boxcar", adaptive = TRUE)
## PRICE MAP
setwd("~/DTU/3. semestr/GIS/project/price map reduced")
# Load the output area shapefiles
pricemap<- readOGR(".", "price map reduced")
View(pricemap)
# Load the output area shapefiles
pricemap<- readOGR(".", "price map reduced")
View(pricemap)
# Load the output area shapefiles
pricemap<- readOGR(".", "price map reduced")
lcrm1 <- gwr.lcr(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA + HUBDISTTR2, data=pricemap, bw=2308, kernel = "boxcar", adaptive = TRUE)
View(price.map.centroids.xy)
View(columbus)
View(price.map.centroids.xy)
View(price.map.centroids.xy.spdf)
View(pricemap)
View(Dub.voter)
# Load the output area shapefiles
pricemap<- readOGR(".", "price map reduced")
pricemap$CENA<-as.double(pricemap$CENA)
View(pricemap)
pricemap$AREA_SQ_M<-as.double(pricemap$AREA_SQ_M)
lcr.pricemap.bw <- bw.gwr.lcr(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA + HUBDISTTR2, data=price.map.centroids.xy.spdf, kernel = "gauss", adaptive=TRUE)
View(Dub.voter)
pricemap$AREA_SQ_M<-as.double(pricemap$AREA_SQ_M)
View(pricemap)
lcr.pricemap.bw <- bw.gwr.lcr(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA + HUBDISTTR2, data=price.map.centroids.xy.spdf, kernel = "gauss", adaptive=TRUE)
View(pricemap)
DeVar <- "CENA"
InDeVars <- c("AREA_SQ_M","HUBDISTBUS","HUBDISTMET","HUBDISTTRA","HUBDISTTR2")
model.sel <-model.selection.gwr(DeVar,InDeVars,data =pricemap, kernel="bisquare", adaptive=TRUE,bw=80)
View(model.sel)
lcr.pricemap.bw <- bw.gwr.lcr(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA + HUBDISTTR2, data=pricemap, kernel = "gauss", adaptive=TRUE)
R> sorted.models <- model.sort.gwr(model.sel, numVars = length(InDeVars),
+
ruler.vector = model.sel[[2]][,2])
R> model.list <- sorted.models[[1]]
R> model.view.gwr(DeVar, InDeVars, model.list = model.list)
R> plot(sorted.models[[2]][,2], col = "black", pch = 20, lty = 5,
+
main = "Alternative view of GWR model selection procedure",
+
ylab = "AICc", xlab = "Model number", type = "b")
sorted.models <- model.sort.gwr(model.sel, numVars = length(InDeVars),
+
ruler.vector = model.sel[[2]][,2])
sorted.models <- model.sort.gwr(model.sel, numVars = length(InDeVars),ruler.vector = model.sel[[2]][,2])
View(sorted.models)
model.list <- sorted.models[[1]]
model.view.gwr(DeVar, InDeVars, model.list = model.list)
plot(sorted.models[[2]][,2], col = "black", pch = 20, lty = 5,
+
main = "Alternative view of GWR model selection procedure",
+
ylab = "AICc", xlab = "Model number", type = "b")
plot(sorted.models[[2]][,2], col = "black", pch = 20, lty = 5,main = "Alternative view of GWR model selection procedure",
ylab = "AICc", xlab = "Model number", type = "b")
model.list <- sorted.models[[1]]
model.view.gwr(DeVar, InDeVars, model.list = model.list)
plot(sorted.models[[2]][,2], col = "black", pch = 20, lty = 5,main = "Alternative view of GWR model selection procedure",
ylab = "AICc", xlab = "Model number", type = "b")
bw.gwr.1 <-bw.gwr(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA +
HUBDISTTR2, data = pricemap,
approach = "AICc", kernel = "bisquare", adaptive = TRUE)
gwr.res <- gwr.basic(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA +
HUBDISTTR2, data = pricemap,
bw = bw.gwr.1,kernel = "bisquare", adaptive = TRUE, F123.test = TRUE)
bw.gwr.1 <-bw.gwr.lcr(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA +
HUBDISTTR2, data = pricemap,
approach = "AICc", kernel = "bisquare", adaptive = TRUE)
bw.gwr.lcr <-bw.gwr.lcr(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA +
HUBDISTTR2, data = pricemap,
kernel = "bisquare", adaptive = TRUE)
View(pricemap)
bw.gwr.lcr <-bw.gwr.lcr(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA +
HUBDISTTR2, data = pricemap,
kernel = "bisquare", adaptive = TRUE, lambda.adjust = TRUE, cn.thresh =30)
bw.gwr.lcr <-bw.gwr.lcr(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA +
HUBDISTTR2, data = pricemap,
kernel = "bisquare", adaptive = TRUE, lambda.adjust = TRUE, cn.thresh =30, longlat=T)
gwr.res <- gwr.basic(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA +
HUBDISTTR2, data = pricemap,
bw = bw.gwr.1,kernel = "bisquare", adaptive = TRUE, F123.test = TRUE)
View(gwr.res)
rgwr.res <- gwr.robust(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA +
HUBDISTTR2, data = pricemap,
bw = bw.gwr.1,kernel = "bisquare", adaptive = TRUE, F123.test = TRUE)
rgwr.res <- gwr.robust(CENA ~ AREA_SQ_M + HUBDISTBUS + HUBDISTMET + HUBDISTTRA +
HUBDISTTR2, data = pricemap,
bw = bw.gwr.1,kernel = "bisquare", adaptive = TRUE, F123.test = TRUE)
save.image("~/DTU/3. semestr/GIS/project/price map reduced/price map reduced.RData")
